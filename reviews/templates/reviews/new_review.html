{% extends "reviews/base.html" %}
{% block content %}
<link rel="stylesheet" href="/reviews/static/css/all.css">
<div class="new">
<form method="POST" enctype="multipart/form-data">
  <h2>Add New review</h2>
    {% csrf_token %}
      <img src="/reviews/static/images/fred-fred-mopping.gif" alt="" style="width: 100px;">
{{ form.title }}
    {{form.rating}}
     {{form.price}}
    <input id="place-autocomplete" type="text" placeholder="The Place" class="form-control">

<input type="hidden" name="place_name" id="place_name">

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCW3ITRLvw3ubpp-xrJ0KyqJsd0AWoZ5xw&libraries=places&language=en"></script>

    <div id="image-fields">
        <input type="file" name="images" required>
    </div>

    <button type="button" onclick="addImageField()">âž• Add New Pic</button>
    <br>
{{form.description}}
    <br><br>
    <button type="submit">Submit</button>
    {% if form.errors %}
    <div class="alert alert-danger">
        <ul>]
        {% for field in form %}
            {% for error in field.errors %}
                <li>{{ error }}</li>
            {% endfor %}
        {% endfor %}
        </ul>
    </div>
{% endif %}
</form>

</div>
<script>
    function addImageField() {
        const container = document.getElementById('image-fields');
        const newInput = document.createElement('input');
        newInput.type = 'file';
        newInput.name = 'images';
        container.appendChild(document.createElement('br'));
        container.appendChild(newInput);
    }

     function initAutocomplete() {
    const input = document.getElementById('place-autocomplete');
    const autocomplete = new google.maps.places.Autocomplete(input, {
      types: ['(cities)'],  
    });

    autocomplete.addListener('place_changed', function () {
      const place = autocomplete.getPlace();
      document.getElementById('place_name').value = place.formatted_address;
    });
  }

  window.onload = initAutocomplete;
initMap();
</script>

{% endblock %}
